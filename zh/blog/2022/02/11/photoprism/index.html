<!doctype html><html lang=en-us><head><script type=text/javascript>var userLang=navigator.language||navigator.userLanguage;console.log(window.location.pathname),userLang.startsWith("zh")&&window.location.pathname=="/"&&(window.location.href="/zh/")</script><script type=text/javascript src=//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js data-dojo-config="usePlainJson: true, isDebug: false"></script><script type=text/javascript>window.dojoRequire(["mojo/signup-forms/Loader"],function(e){e.start({baseUrl:"mc.us4.list-manage.com",uuid:"6ace4137554cb923d96ec92c7",lid:"36ce78d7a8",uniqueMethods:!0})})</script>
<script async src=https://cdn.splitbee.io/sb.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>PhotoPrism配合Lomorage，完美替换Google Photo的完美方案 | Lomorage</title><link href="https://fonts.googleapis.com/css?family=Lato:400" rel=stylesheet><script defer src=https://use.fontawesome.com/releases/v5.15.3/js/all.js></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-138235951-1","auto"),ga("send","pageview"))</script><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.8.1/css/all.css integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf crossorigin=anonymous><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=stylesheet type=text/css href=/css/style.a2d4ddf024fd938e5bbbf2d62c2f17987b805f53b4cc89d360109c27d51e9458.min.css></head><body><div class="navbar navbar--extended"><nav class=nav__mobile></nav><div class=container><div class=navbar__inner><a href=/ class=navbar__logo>Lomorage</a><nav class=navbar__menu><ul><li><a href=/zh>主页</a></li><li><a href=https://lomosw.lomorage.com/zh/index.html class="button button__accent">立即下载</a></li><li><a href=/zh/survey/>调查问卷</a></li><li><a href=/zh/faq/>常见问题</a></li><li><a href=/zh/blog/>博客</a></li><li><a href=/zh/contact/>联系</a></li></ul></nav><div class=navbar__menu-mob><a href id=toggle><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M16 132h416c8.837.0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163.0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837.0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837.0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg></a></div></div></div></div><div class=page__header><div class="hero__overlay hero__overlay--gradient"></div><div class=hero__mask></div><div class=page__header__inner><div class=container><div class=page__header__content><div class=page__header__content__inner id=navConverter><h1 class=page__header__title>PhotoPrism配合Lomorage，完美替换Google Photo的完美方案</h1></div></div></div></div></div><div class=page><div class=container><div class=page__inner><div class=page__main><div class=text-container><p>PhotoPrism是一款开源的智能AI照片视频管理工具，能非常好的搭配Lomorage使用。</p><p><img src=https://camo.githubusercontent.com/5e03a87e47aad26ad7248b8b43eac6471fe96f7b655ac2e532697692753c3ff8/68747470733a2f2f646c2e70686f746f707269736d2e6170702f696d672f75692f6465736b746f702d3130303070782e6a7067 alt="PhotoPrism Screenshot"></p><ul><li><p>强大的搜索功能，可以按人，地点，物体和色彩来搜索</p></li><li><p>高精度的地图模式</p></li><li><p>人脸识别</p></li><li><p>自动基于图片内容和地点的自动分类</p></li><li><p>提取并索引照片视频中的元信息(EXIF/XMP)</p></li></ul><p>PhotoPrism有个demo站点，大家可以试试，<a href=https://demo-zh.photoprism.app/browse>https://demo-zh.photoprism.app/browse</a>。</p><p>PhotoPrism现在比较成熟的是Web应用，手机端的<a href=https://github.com/thielepaul/photoprism-mobile>应用</a>由第三方开发，还不太成熟，现在还在测试阶段，并且涉及到服务端API的<a href=https://github.com/photoprism/photoprism/pull/995>改动</a>还没有合并到主干代码仓库中，官方说精力不够，还没有时间来做代码审查。</p><p>对于想把手机同步备份到PhotoPrism的用户，官方推荐的是用<a href=https://www.photosync-app.com/home.html>PhotoSync</a>，但PhotoSync如果要原始尺寸备份是需要<a href=https://www.photosync-app.com/support/ios/answers/what-is-the-difference-between-photosync-pro-and-premium.html>收费</a>的，Pro版本的是40块一次性购买，Premium版本是45块一年，或者6块一个月，或者163块一次性购买。对于一般手机照片备份的场景，Pro版本就够用了。<a href=https://lomorage.com>Lomorage</a>现在除了云端备份不支持外，其他Pro版本的功能都有了，0成本，而且Lomorage也能和Photoprism完美整合，下面的步骤就一步步的演示如何在<strong>树莓派4</strong>上安装配置PhotoPrism，因为PhotoPrism是基于Docker容器的部署安装，其他的平台安装方法也是类似的，大家可以参考<a href=https://docs.photoprism.app/getting-started/docker-compose/>官方文档</a>。</p><h2 id=1-安装docker>1. 安装Docker</h2><pre tabindex=0><code>$ sudo apt install -y ca-certificates
$ sudo update-ca-certificates --fresh
$ curl -fSLs https://get.docker.com | sudo sh
$ sudo usermod -aG docker $USER
$ sudo systemctl start docker
$ sudo docker info
</code></pre><h2 id=2-安装docker-compose>2. 安装Docker-Compose</h2><pre tabindex=0><code>$ sudo apt-get install libffi-dev libssl-dev
$ sudo apt install python3-dev
$ sudo apt-get install -y python3 python3-pip
$ sudo pip3 install docker-compose
</code></pre><h2 id=3-下载photoprism的yaml配置文件>3. 下载PhotoPrism的yaml配置文件</h2><p>如果使用64位系统:</p><pre tabindex=0><code>$ mkdir ~/photoprism
$ wget https://dl.photoprism.app/docker/arm64/docker-compose.yml -O ~/photoprism/docker-compose.yml
</code></pre><p>如果使用32位系统:</p><pre tabindex=0><code>$ mkdir ~/photoprism
$ wget https://dl.photoprism.app/docker/armv7/docker-compose.yml -O ~/photoprism/docker-compose.yml
</code></pre><h2 id=4-修改配置文件>4. 修改配置文件</h2><p>修改docker-compose.yml中的配置项。</p><p>如果需要使用密码验证，可以修改密码，用户名是admin。</p><pre tabindex=0><code>PHOTOPRISM_ADMIN_PASSWORD: &#34;insecure&#34;          # !!! PLEASE CHANGE YOUR INITIAL &#34;admin&#34; PASSWORD !!!
</code></pre><p>如果不需要验证，<code>PHOTOPRISM_AUTH_MODE</code>直接改成"public"禁用即可。</p><pre tabindex=0><code>PHOTOPRISM_AUTH_MODE: &#34;public&#34;               # authentication mode (public, password)
</code></pre><p>修改访问地址，将<code>PHOTOPRISM_SITE_URL</code>中的"localhost"替换为树莓派的ip地址，端口2342不用改。</p><pre tabindex=0><code>PHOTOPRISM_SITE_URL: &#34;http://localhost:2342/&#34;  # public server URL incl http:// or https:// and /path, :port is optional
</code></pre><p>如果需要改端口，除了修改上面的默认的2342端口，还要修改ports的映射:</p><pre tabindex=0><code>    ports:
      - &#34;2342:2342&#34; # HTTP port (host:container)
</code></pre><p>比如2342修改为80，如果树莓派ip地址是192.168.1.100那需要修改为:</p><pre tabindex=0><code>    ports:
      - &#34;80:2342&#34; # HTTP port (host:container)
    environment:
      PHOTOPRISM_SITE_URL: &#34;http://192.168.1.100:80/&#34;
</code></pre><p>对于使用Lomorage进行照片备份，并配合PhotoPrism进行索引的，只需要修改映射目录即可，下面的例子磁盘挂载在"/media/WD_90C27F73C27F5C82"目录下，Lomorage系统有bob和alice两个用户，我们把目录设置到了master这一个层级，这样就不会索引preview目录了，映射到docker里面的目录必须是在"/photoprism/originals"下面。</p><p>PhotoPrism分析照片视频的会生成一些缓存和缩略图，元数据文件等，需要额外的目录来存储，下面的例子中创建了"photoprismStorage"目录。</p><pre tabindex=0><code>    volumes:
      ## The *originals* folder contains your original photo and video files (- &#34;[host folder]:/photoprism/originals&#34;):
      - &#34;/media/WD_90C27F73C27F5C82/bob/Photos/master/:/photoprism/originals/bob&#34;
      - &#34;/media/WD_90C27F73C27F5C82/alice/Photos/master/:/photoprism/originals/alice&#34;
      ## Cache, session, thumbnail, and sidecar files will be created in the *storage* folder (never remove):
      - &#34;/media/WD_90C27F73C27F5C82/photoprismStorage:/photoprism/storage&#34;
</code></pre><p>最后，我们设置<code>PHOTOPRISM_READONLY</code>为"true"，确保我们的原始的Lomorage数据目录不被修改。</p><pre tabindex=0><code>PHOTOPRISM_READONLY: &#34;true&#34;                   # don&#39;t modify originals folder; disables import, upload, and delete
</code></pre><p>数据库使用sqlite也够用了，去掉默认的，设置为空"&ldquo;即可.</p><pre tabindex=0><code>      PHOTOPRISM_DATABASE_DRIVER: &#34;&#34;            # use MariaDB 10.5+ or MySQL 8+ instead of SQLite for improved performance
</code></pre><h2 id=5-启动photoprism>5. 启动PhotoPrism</h2><p>执行下面的命令，会花一些时间下载PhotoPrism镜像，然后启动应用。</p><pre tabindex=0><code>$ docker-compose up -d
</code></pre><p>启动完成后，访问http://[your-raspberrypi-ip]:2342，点击左侧栏的<a href=https://demo.photoprism.app/library>Library菜单</a>，打开索引设置，点击Start按钮开始索引，构建索引会花点时间，索引过程中也可以使用PhotoPrism浏览已经扫描过的照片。PhotoPrism中文支持的不错，打开Setting菜单，可以修改语言为中文。</p><p>如果我们想让每天自动构建索引，无需人工触发，可以通过cronjob，创建/etc/cron.daily/photoprism-index，输入如下内容，其中<code>/home/pi/photoprism</code>为前面的配置文件所在路径。</p><pre tabindex=0><code>#!/bin/sh
cd /home/pi/photoprism &amp;&amp; docker-compose exec -T photoprism photoprism index
</code></pre><p>添加可执行权限:</p><pre tabindex=0><code>$ sudo chmod +x /etc/cron.daily/photoprism-index
</code></pre><p>到此为止，PhotoPrism的安装配置就完成了，可以通过电脑或手机浏览器使用PhotoPrism。</p><p>如果您在安装过程中碰到什么问题，欢迎和我们联系。</p></div><div id=comments><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//lomorage.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></div></div><div class="footer footer--dark"><div class=container><div class=footer__inner><a href=/ class=footer__textLogo>Lomorage</a><div class=footer__data><div class=footer__data__item><div class=footer__row><a href=https://github.com/lomorage/homepage target=_blank style=opacity:1><i class='fab fa-2x fa-github'></i></a></div></div><div class=footer__data__item><div class=footer__row><a href=https://join.slack.com/t/lomorage/shared_invite/enQtODc4MTE5ODQzNzkyLTRlY2U4MTQ1YjczYjBhMDcwMmExYTUxNTg2NTE5YmRkZjg2ZWQwZjg1MjEwMjQzZWVjMmEwZjk3ZGIyODY4ODM target=_blank style=opacity:1><i class='fab fa-2x fa-slack'></i></a></div></div><div class=footer__data__item><div class=footer__row><a href=mailto:support@lomorage.com target=_blank style=opacity:1><i class='fa fa-2x fa-envelope'></i></a></div></div></div></div><div class=footer__inner></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://unpkg.com/ionicons@4.4.7/dist/ionicons.js></script><div class=scripts><script type=text/javascript src=/js/scripts.min.0ace95f16c4ea7b11cb1ffa10c2fe8f2f87bea22847c95cdb98e86138a51e7fe.js></script></div></body></html>